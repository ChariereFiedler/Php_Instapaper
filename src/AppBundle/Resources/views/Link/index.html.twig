{% extends "AppBundle::template.html.twig" %}

{% block javascript %}
    {{ parent() }}
{% endblock %}


{% block content %}
    {% include "AppBundle:Common:_contentListRow.html.twig" with {'data' : data, 'icon' : 'fa-home', 'title' : 'Home', 'editable' : false} only %}

    <script type="text/javascript">
        $("delete-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var target = $(that).data("target");
            if(target) {
                $(that).parents("div[name="+target+"]").slideUp();
            }

            $.ajax({
                type: "DELETE",
                contentType: "application/json",
                url: "/links/"+id,
                processData: false,
                dataType: "json",
                success: function(result) {

                },
                error: function(result) {
                    if(target) {
                        $(that).parents("div[name="+target+"]").slideDown();
                    }
                }
            });
        });
    </script>

    <script type="text/javascript">
        $("like-link").click(function(){
            var that = this;
            var id = $(that).data("id");
            var target = $(that).data("target");

            $(that).hide();
            $(that).parent("li").children("unlike-link").show();

            var data = {'liked' : true};
            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json",
                error: function(result) {
                    $(that).parent("li").children("unlike-link").hide();
                    $(that).show();
                }
            });
        });
    </script>

    <script type="text/javascript">
        $("unlike-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            $(that).hide();
            $(that).parent("li").children("like-link").show();

            var data = {'liked' : false};

            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json",
                error: function(result) {
                    $(that).parent("li").children("like-link").hide();
                    $(that).show();
                }
            });
        });
    </script>


    <script type="text/javascript">
        $("archive-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var target = $(that).data("target");
            if(target) {
                $(that).parents("div[name="+target+"]").slideUp();
            }

            var data = {'archived' : true};
            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json",
                succes: function(result) {
                },
                error: function(result) {
                    if(target) {
                        $(that).parents("div[name="+target+"]").slideDown();
                    }
                }
            });
        });
    </script>

    <script type="text/javascript">
        $("restore-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var target = $(that).data("target");
            if(target) {
                $(that).parents("div[name="+target+"]").slideUp();
            }

            var data = {'archived' : false};
            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json",
                succes: function(result) {
                },
                error: function(result) {
                    if(target) {
                        $(that).parents("div[name="+target+"]").slideDown();
                    }
                }
            });
        });
    </script>

{% endblock %}
