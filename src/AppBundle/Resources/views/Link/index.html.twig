{% extends "AppBundle::template.html.twig" %}

{% block javascript %}
    {{ parent() }}
{% endblock %}


{% block content %}
    {% include "AppBundle:Common:_contentListRow.html.twig" with {'data' : data, 'icon' : 'fa-home', 'title' : 'Home', 'editable' : false} only %}

    <script type="text/javascript">
        $("delete-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var target = $(that).data("target");
            if(target) {
                $(that).parents("div[name="+target+"]").slideUp();
            }

            $.ajax({
                type: "DELETE",
                contentType: "application/json",
                url: "/links/"+id,
                processData: false,
                dataType: "json",
                success: function(result) {

                },
                error: function(result) {
                    if(target) {
                        $(that).parents("div[name="+target+"]").slideDown();
                    }
                }
            });
        });
    </script>

    <script type="text/javascript">
        $("like-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var data = [
                { "op": "replace", "path": "/liked", "value": true },
            ];
            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json"
            });
        });
    </script>

    <script type="text/javascript">
        $("unlike-link").click(function(){
            var that = this;
            var id = $(that).data("id");

            var data = [
                { "op": "replace", "path": "/liked", "value": false },
            ];

            console.dir(data);
            $.ajax({
                type: "PATCH",
                contentType: "application/json",
                url: "/links/"+id,
                data: JSON.stringify(data),
                processData: false,
                dataType: "json"
            });
        });
    </script>



{% endblock %}
